########################################################################################################
# HOG.R
#
# Analysis of malware textures using histogram of oriented gradients
#
# Author: Eduarda Chagas
# Date : Set 2020
# Contact: eduarda.chagas@dcc.ufmg.br
########################################################################################################

############################################# Packages #################################################
if(!require(gtools)){
  install.packages("gtools")
  require(gtools)
}
if(!require(OpenImageR)){
  install.packages("OpenImageR")
  require(OpenImageR)
}

###################################### Function of Analysis ##########################################

HOG.analysis <- function(){
  n.images = 9339
  hog.data = matrix(nrow = n.images, ncol = 54)
  
  for(j in c(1:n.images)){
    img = readImage(paste0("../IMG/X[", j-1,  "].png"))
    img = img[,,1]
    img = t(apply(img, 2, rev)) 
    
    hog.data[j,] = HOG(img, cells = 3, orientations = 6)
    cat("Malware ", j, " of ", n.images, "\n")
  }
  write.csv(hog.data,'../Data/HOG.csv', row.names = FALSE)
}

HOG.analysis()